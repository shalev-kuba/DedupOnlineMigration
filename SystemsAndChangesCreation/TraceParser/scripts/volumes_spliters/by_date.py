DATE_TO_INDEX = {
    '03/09/2009': 0,
    '04/09/2009': 0,
    '05/09/2009': 0,
    '06/09/2009': 0,
    '07/09/2009': 0,
    '10/09/2009': 1,
    '11/09/2009': 1,
    '12/09/2009': 1,
    '13/09/2009': 1,
    '14/09/2009': 1,
    '17/09/2009': 2,
    '18/09/2009': 2,
    '19/09/2009': 2,
    '20/09/2009': 2,
    '21/09/2009': 2,
    '22/09/2009': 2,
    '24/09/2009': 3,
    '25/09/2009': 3,
    '26/09/2009': 3,
    '27/09/2009': 3,
    '28/09/2009': 3,
    '01/10/2009': 4,
    '02/10/2009': 4,
    '03/10/2009': 4,
    '04/10/2009': 4,
    '05/10/2009': 4,
    '08/10/2009': 5,
    '09/10/2009': 5,
    '10/10/2009': 5,
    '11/10/2009': 5,
    '12/10/2009': 5,
    '15/10/2009': 6,
    '16/10/2009': 6,
    '17/10/2009': 6,
    '18/10/2009': 6,
    '19/10/2009': 6,
    '22/10/2009': 7,
    '23/10/2009': 7,
    '24/10/2009': 7,
    '25/10/2009': 7,
    '26/10/2009': 7,
}


def volume_index_by_date(snap, num_volumes):
    DATE_FORMAT = '%d/%m/%Y'
    date_as_str = snap.date.strftime(DATE_FORMAT)
    if date_as_str not in DATE_TO_INDEX:
        return -1

    index = DATE_TO_INDEX[date_as_str]

    if index > (num_volumes - 1):
        return -1

    return index
